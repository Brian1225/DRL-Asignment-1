  0%|                                                                                                                               | 0/5000 [00:00<?, ?it/s]/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:45: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(state, dtype=torch.float32).to(self.device),
/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:48: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(next_state, dtype=torch.float32).to(self.device),
 64%|██████████████████████████████████████████████████████████████████████████▏                                         | 3199/5000 [09:36<05:51,  5.12it/s]
Episode: 100, Average reward: -207.79399999999987, Avg Loss: 18.60139796313364, Epsilon: 0.951217530242334
Episode: 200, Average reward: -199.89999999999986, Avg Loss: 12.903777683861554, Epsilon: 0.9048147898403269
Episode: 300, Average reward: -190.59999999999985, Avg Loss: 11.099882994902437, Epsilon: 0.8606756897186528
Episode: 400, Average reward: -186.74999999999986, Avg Loss: 11.203406451675692, Epsilon: 0.8186898039137951
Episode: 500, Average reward: -174.39999999999986, Avg Loss: 11.462107330048457, Epsilon: 0.7787520933134615
Episode: 600, Average reward: -165.13399999999987, Avg Loss: 12.492705939045699, Epsilon: 0.7407626428726788
Episode: 700, Average reward: -158.89999999999986, Avg Loss: 13.446142706574173, Epsilon: 0.7046264116491338
Episode: 800, Average reward: -148.24599999999987, Avg Loss: 13.855617177670938, Epsilon: 0.6702529950324074
Episode: 900, Average reward: -150.84199999999987, Avg Loss: 12.614309894798788, Epsilon: 0.637556398572254
Episode: 1000, Average reward: -138.7769999999999, Avg Loss: 12.57949623040855, Epsilon: 0.606454822840097
Episode: 1100, Average reward: -140.7499999999999, Avg Loss: 12.0685590978252, Epsilon: 0.5768704587855094
Episode: 1200, Average reward: -123.92299999999994, Avg Loss: 12.318281614684384, Epsilon: 0.548729293075715
Episode: 1300, Average reward: -122.89999999999992, Avg Loss: 13.613748203096911, Epsilon: 0.5219609229311034
Episode: 1400, Average reward: -119.54999999999993, Avg Loss: 13.51959852693195, Epsilon: 0.49649837999353363
Episode: 1500, Average reward: -116.94999999999995, Avg Loss: 12.769785995204002, Epsilon: 0.4722779627867691
Episode: 1600, Average reward: -108.49999999999996, Avg Loss: 13.007118099277141, Epsilon: 0.44923907734991153
Episode: 1700, Average reward: -103.54999999999997, Avg Loss: 12.071992397298454, Epsilon: 0.4273240856451275
Episode: 1800, Average reward: -104.49999999999996, Avg Loss: 12.187830345785187, Epsilon: 0.406478161360422
Episode: 1900, Average reward: -97.79999999999997, Avg Loss: 12.601262819307157, Epsilon: 0.3866491527467055
Episode: 2000, Average reward: -89.82499999999996, Avg Loss: 12.48318953231268, Epsilon: 0.3677874521460121
Episode: 2100, Average reward: -89.46599999999997, Avg Loss: 13.25274496589147, Epsilon: 0.34984587188445015
Episode: 2200, Average reward: -89.49999999999996, Avg Loss: 13.664929228434339, Epsilon: 0.3327795262194029
Episode: 2300, Average reward: -85.3, Avg Loss: 13.008143615328008, Epsilon: 0.31654571904563433
Episode: 2400, Average reward: -80.69999999999999, Avg Loss: 12.66930172518536, Epsilon: 0.3011038370793723
Episode: 2500, Average reward: -79.99799999999999, Avg Loss: 12.109768817190488, Epsilon: 0.28641524825313086
Episode: 2600, Average reward: -73.2, Avg Loss: 13.017165900957771, Epsilon: 0.27244320506708813
Episode: 2700, Average reward: -74.3, Avg Loss: 13.577188935016748, Epsilon: 0.25915275265522114
Episode: 2800, Average reward: -69.404, Avg Loss: 13.53104825647606, Epsilon: 0.24651064133620196
Episode: 2900, Average reward: -62.920000000000016, Avg Loss: 13.737262382793997, Epsilon: 0.23448524343027585
Episode: 3000, Average reward: -63.786000000000016, Avg Loss: 12.498774455392267, Epsilon: 0.22304647413401948
Episode: 3100, Average reward: -62.00000000000002, Avg Loss: 12.78888405833859, Epsilon: 0.21216571625502262
Episode: 3200, Average reward: -57.69400000000002, Avg Loss: 12.737111512424017, Epsilon: 0.2018157486181985
Episode: 3300, Average reward: -60.45000000000001, Avg Loss: 12.798078350314753, Epsilon: 0.1919706779646106
Episode: 3400, Average reward: -48.25000000000002, Avg Loss: 13.430266819597163, Epsilon: 0.1826058741724434
Episode: 3500, Average reward: -51.02700000000002, Avg Loss: 12.522298185879482, Epsilon: 0.17369790863805412
Episode: 3600, Average reward: -50.15000000000002, Avg Loss: 12.063234446402056, Epsilon: 0.1652244956629483
Episode: 3700, Average reward: -48.70000000000002, Avg Loss: 12.757314928050036, Epsilon: 0.1571644367000449
Episode: 3800, Average reward: -44.60000000000003, Avg Loss: 12.205237940174992, Epsilon: 0.1494975673197442
Episode: 3900, Average reward: -44.00000000000002, Avg Loss: 11.842094825519599, Epsilon: 0.1422047067631241
Episode: 4000, Average reward: -46.90000000000002, Avg Loss: 12.576560848442314, Epsilon: 0.13526760995605422
Episode: 4100, Average reward: -42.600000000000016, Avg Loss: 12.439479038825375, Epsilon: 0.12866892186418147
Episode: 4200, Average reward: -46.40000000000002, Avg Loss: 12.083582057889435, Epsilon: 0.12239213407459068
Episode: 4300, Average reward: -44.09800000000002, Avg Loss: 12.967049855238583, Epsilon: 0.1164215434955208
Episode: 4400, Average reward: -39.55000000000002, Avg Loss: 13.271252122702426, Epsilon: 0.11074221307080971
Episode: 4500, Average reward: -37.742000000000026, Avg Loss: 11.82454604319617, Epsilon: 0.10533993441078586
Episode: 4600, Average reward: -35.55000000000002, Avg Loss: 10.345050855062146, Epsilon: 0.1002011922461172
Episode: 4700, Average reward: -37.100000000000016, Avg Loss: 10.41369473011131, Epsilon: 0.1
Episode: 4800, Average reward: -36.25000000000002, Avg Loss: 10.386820262612892, Epsilon: 0.1
Episode: 4900, Average reward: -37.70000000000001, Avg Loss: 10.624510618329223, Epsilon: 0.1
Episode: 5000, Average reward: -34.79400000000001, Avg Loss: 11.037242611054388, Epsilon: 0.1
