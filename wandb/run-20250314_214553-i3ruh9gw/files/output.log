  0%|                                                                                                                              | 0/10000 [00:00<?, ?it/s]/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:45: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(state, dtype=torch.float32).to(self.device),
/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:48: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(next_state, dtype=torch.float32).to(self.device),
 32%|████████████████████████████████████▊                                                                              | 3199/10000 [09:42<20:22,  5.56it/s]
Episode: 100, Average reward: -212.69999999999985, Avg Loss: 18.636871642513434, Epsilon: 0.951217530242334
Episode: 200, Average reward: -192.99999999999986, Avg Loss: 11.513432563828538, Epsilon: 0.9048147898403269
Episode: 300, Average reward: -185.89999999999986, Avg Loss: 9.417269345048117, Epsilon: 0.8606756897186528
Episode: 400, Average reward: -181.84999999999985, Avg Loss: 7.21601235813112, Epsilon: 0.8186898039137951
Episode: 500, Average reward: -179.94999999999985, Avg Loss: 5.077519578392384, Epsilon: 0.7787520933134615
Episode: 600, Average reward: -159.01299999999986, Avg Loss: 4.236139296020265, Epsilon: 0.7407626428726788
Episode: 700, Average reward: -151.84999999999988, Avg Loss: 3.441000463750388, Epsilon: 0.7046264116491338
Episode: 800, Average reward: -149.9939999999999, Avg Loss: 2.8342376363184303, Epsilon: 0.6702529950324074
Episode: 900, Average reward: -134.9499999999999, Avg Loss: 3.0085335925180696, Epsilon: 0.637556398572254
Episode: 1000, Average reward: -137.9499999999999, Avg Loss: 2.7866581890312956, Epsilon: 0.606454822840097
Episode: 1100, Average reward: -137.09999999999994, Avg Loss: 1.8273757792747347, Epsilon: 0.5768704587855094
Episode: 1200, Average reward: -123.04999999999993, Avg Loss: 2.175729439833958, Epsilon: 0.548729293075715
Episode: 1300, Average reward: -114.84999999999992, Avg Loss: 2.6241877795773325, Epsilon: 0.5219609229311034
Episode: 1400, Average reward: -113.14899999999994, Avg Loss: 2.7348486867587782, Epsilon: 0.49649837999353363
Episode: 1500, Average reward: -112.49999999999993, Avg Loss: 2.943586307563819, Epsilon: 0.4722779627867691
Episode: 1600, Average reward: -108.34999999999992, Avg Loss: 2.8642050458563606, Epsilon: 0.44923907734991153
Episode: 1700, Average reward: -101.29999999999997, Avg Loss: 2.249935453579237, Epsilon: 0.4273240856451275
Episode: 1800, Average reward: -94.09499999999997, Avg Loss: 1.4874739807951847, Epsilon: 0.406478161360422
Episode: 1900, Average reward: -93.34999999999997, Avg Loss: 1.8362015591371164, Epsilon: 0.3866491527467055
Episode: 2000, Average reward: -90.43499999999996, Avg Loss: 2.2395511187342345, Epsilon: 0.3677874521460121
Episode: 2100, Average reward: -86.78099999999996, Avg Loss: 2.9099573215493, Epsilon: 0.34984587188445015
Episode: 2200, Average reward: -80.86799999999998, Avg Loss: 3.732503460308071, Epsilon: 0.3327795262194029
Episode: 2300, Average reward: -77.99999999999999, Avg Loss: 3.6368132780649467, Epsilon: 0.31654571904563433
Episode: 2400, Average reward: -74.85, Avg Loss: 2.779298784044804, Epsilon: 0.3011038370793723
Episode: 2500, Average reward: -74.943, Avg Loss: 1.7802943245650384, Epsilon: 0.28641524825313086
Episode: 2600, Average reward: -72.9, Avg Loss: 1.3897776861826423, Epsilon: 0.27244320506708813
Episode: 2700, Average reward: -66.23200000000001, Avg Loss: 1.8767072933516464, Epsilon: 0.25915275265522114
Episode: 2800, Average reward: -61.35000000000001, Avg Loss: 2.335207269283419, Epsilon: 0.24651064133620196
Episode: 2900, Average reward: -60.45000000000002, Avg Loss: 2.324184113359661, Epsilon: 0.23448524343027585
Episode: 3000, Average reward: -57.42500000000002, Avg Loss: 2.385754865469644, Epsilon: 0.22304647413401948
Episode: 3100, Average reward: -56.65000000000002, Avg Loss: 2.69497320828028, Epsilon: 0.21216571625502262
Episode: 3200, Average reward: -54.24300000000002, Avg Loss: 2.772023972650641, Epsilon: 0.2018157486181985
Episode: 3300, Average reward: -52.77000000000002, Avg Loss: 2.4401105985912728, Epsilon: 0.1919706779646106
Episode: 3400, Average reward: -49.100000000000016, Avg Loss: 1.5379620108683594, Epsilon: 0.1826058741724434
Episode: 3500, Average reward: -49.90000000000002, Avg Loss: 1.5747748626742395, Epsilon: 0.17369790863805412
Episode: 3600, Average reward: -49.20000000000002, Avg Loss: 3.1099905147444225, Epsilon: 0.1652244956629483
Episode: 3700, Average reward: -47.30000000000002, Avg Loss: 2.6399695115079522, Epsilon: 0.1571644367000449
Episode: 3800, Average reward: -44.100000000000016, Avg Loss: 0.6791326826353906, Epsilon: 0.1494975673197442
Episode: 3900, Average reward: -43.30000000000002, Avg Loss: 1.1587865741740098, Epsilon: 0.1422047067631241
Episode: 4000, Average reward: -41.80000000000002, Avg Loss: 2.2271039260027465, Epsilon: 0.13526760995605422
Episode: 4100, Average reward: -38.850000000000016, Avg Loss: 1.9543638120501419, Epsilon: 0.12866892186418147
Episode: 4200, Average reward: -35.42200000000002, Avg Loss: 1.1751057457958813, Epsilon: 0.12239213407459068
Episode: 4300, Average reward: -40.25000000000002, Avg Loss: 1.8940124842774821, Epsilon: 0.1164215434955208
Episode: 4400, Average reward: -38.40000000000002, Avg Loss: 2.8660584644193294, Epsilon: 0.11074221307080971
Episode: 4500, Average reward: -37.44700000000001, Avg Loss: 2.3114488480452566, Epsilon: 0.10533993441078586
Episode: 4600, Average reward: -36.350000000000016, Avg Loss: 1.967512626790267, Epsilon: 0.1002011922461172
Episode: 4700, Average reward: -36.20000000000002, Avg Loss: 1.8343281096598367, Epsilon: 0.1
Episode: 4800, Average reward: -33.80000000000001, Avg Loss: 2.028203530705359, Epsilon: 0.1
Episode: 4900, Average reward: -38.00000000000002, Avg Loss: 2.4120167349561235, Epsilon: 0.1
Episode: 5000, Average reward: -37.80000000000002, Avg Loss: 2.74237521205534, Epsilon: 0.1
Episode: 5100, Average reward: -34.85000000000001, Avg Loss: 1.8480879717919743, Epsilon: 0.1
Episode: 5200, Average reward: -36.05000000000001, Avg Loss: 1.5534171178111864, Epsilon: 0.1
Episode: 5300, Average reward: -36.10000000000001, Avg Loss: 2.9104176784688023, Epsilon: 0.1
Episode: 5400, Average reward: -32.70000000000002, Avg Loss: 2.875734547675238, Epsilon: 0.1
Episode: 5500, Average reward: -34.96500000000001, Avg Loss: 2.3102141523585304, Epsilon: 0.1
Episode: 5600, Average reward: -35.45000000000001, Avg Loss: 2.4552356023597532, Epsilon: 0.1
Episode: 5700, Average reward: -32.95000000000001, Avg Loss: 1.6646775063418318, Epsilon: 0.1
Episode: 5800, Average reward: -32.49800000000002, Avg Loss: 1.6031212305091322, Epsilon: 0.1
Episode: 5900, Average reward: -34.45000000000002, Avg Loss: 1.6363838334562024, Epsilon: 0.1
Episode: 6000, Average reward: -33.15000000000001, Avg Loss: 1.5469168979515961, Epsilon: 0.1
Episode: 6100, Average reward: -33.58400000000002, Avg Loss: 0.8656547766567383, Epsilon: 0.1
Episode: 6200, Average reward: -37.750000000000014, Avg Loss: 1.3474527081179257, Epsilon: 0.1
Episode: 6300, Average reward: -37.40000000000002, Avg Loss: 1.182186905517883, Epsilon: 0.1
Episode: 6400, Average reward: -35.100000000000016, Avg Loss: 0.9142091782751232, Epsilon: 0.1
Episode: 6500, Average reward: -34.600000000000016, Avg Loss: 0.708627581926994, Epsilon: 0.1
Episode: 6600, Average reward: -35.600000000000016, Avg Loss: 0.5066239615176165, Epsilon: 0.1
Episode: 6700, Average reward: -34.10000000000001, Avg Loss: 0.7789746626940905, Epsilon: 0.1
Episode: 6800, Average reward: -32.55000000000001, Avg Loss: 1.0505748034178395, Epsilon: 0.1
Episode: 6900, Average reward: -37.90000000000002, Avg Loss: 1.09791807098969, Epsilon: 0.1
Episode: 7000, Average reward: -34.75000000000002, Avg Loss: 0.5975738502293825, Epsilon: 0.1
Episode: 7100, Average reward: -35.899000000000015, Avg Loss: 0.5076629228844104, Epsilon: 0.1
Episode: 7200, Average reward: -34.100000000000016, Avg Loss: 1.0500933572370559, Epsilon: 0.1
Episode: 7300, Average reward: -36.73300000000002, Avg Loss: 1.4478982575662667, Epsilon: 0.1
Episode: 7400, Average reward: -34.314000000000014, Avg Loss: 1.6586732501169899, Epsilon: 0.1
Episode: 7500, Average reward: -35.69200000000001, Avg Loss: 1.3355879368497698, Epsilon: 0.1
Episode: 7600, Average reward: -36.20000000000002, Avg Loss: 1.789671670166281, Epsilon: 0.1
Episode: 7700, Average reward: -35.698000000000015, Avg Loss: 1.6505503929387486, Epsilon: 0.1
Episode: 7800, Average reward: -33.59000000000002, Avg Loss: 1.2393640307664464, Epsilon: 0.1
Episode: 7900, Average reward: -36.47500000000001, Avg Loss: 2.2417716428548737, Epsilon: 0.1
Episode: 8000, Average reward: -39.35000000000001, Avg Loss: 3.3878567184333224, Epsilon: 0.1
Episode: 8100, Average reward: -35.70000000000002, Avg Loss: 2.9755983214249135, Epsilon: 0.1
Episode: 8200, Average reward: -34.48200000000001, Avg Loss: 1.2693551960418699, Epsilon: 0.1
Episode: 8300, Average reward: -33.08600000000002, Avg Loss: 1.4239459140441613, Epsilon: 0.1
Episode: 8400, Average reward: -33.30000000000001, Avg Loss: 1.2351643388229423, Epsilon: 0.1
Episode: 8500, Average reward: -34.488000000000014, Avg Loss: 0.9010690275857632, Epsilon: 0.1
Episode: 8600, Average reward: -31.71600000000001, Avg Loss: 1.4698066549684154, Epsilon: 0.1
Episode: 8700, Average reward: -35.09700000000001, Avg Loss: 3.981826653367607, Epsilon: 0.1
Episode: 8800, Average reward: -32.80000000000001, Avg Loss: 3.854235159922391, Epsilon: 0.1
Episode: 8900, Average reward: -35.850000000000016, Avg Loss: 1.871021459181793, Epsilon: 0.1
Episode: 9000, Average reward: -34.71800000000001, Avg Loss: 1.4437610529040104, Epsilon: 0.1
Episode: 9100, Average reward: -35.20000000000001, Avg Loss: 1.8726536181705888, Epsilon: 0.1
Episode: 9200, Average reward: -34.85000000000001, Avg Loss: 1.4506027573079336, Epsilon: 0.1
Episode: 9300, Average reward: -38.30000000000001, Avg Loss: 1.3472768218215787, Epsilon: 0.1
Episode: 9400, Average reward: -34.75000000000001, Avg Loss: 1.9461238914902788, Epsilon: 0.1
Episode: 9500, Average reward: -31.900000000000013, Avg Loss: 1.751834197139251, Epsilon: 0.1
Episode: 9600, Average reward: -34.000000000000014, Avg Loss: 1.3506284590795985, Epsilon: 0.1
Episode: 9700, Average reward: -34.000000000000014, Avg Loss: 1.4787137309464742, Epsilon: 0.1
Episode: 9800, Average reward: -33.55000000000001, Avg Loss: 2.061381919050618, Epsilon: 0.1
Episode: 9900, Average reward: -36.40000000000002, Avg Loss: 1.969403501286579, Epsilon: 0.1
Episode: 10000, Average reward: -32.93300000000002, Avg Loss: 2.152602058847551, Epsilon: 0.1
