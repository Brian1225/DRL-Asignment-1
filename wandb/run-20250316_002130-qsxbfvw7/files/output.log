  0%|                                                                                                                              | 0/10000 [00:00<?, ?it/s]/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:45: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(state, dtype=torch.float32).to(self.device),
/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:48: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(next_state, dtype=torch.float32).to(self.device),
 32%|████████████████████████████████████▊                                                                              | 3199/10000 [10:32<22:19,  5.08it/s]
Episode: 100, Average reward: -202.84999999999985, Avg Loss: 158.778177318573, Epsilon: 0.951217530242334
Episode: 200, Average reward: -194.94999999999985, Avg Loss: 78.73608997732401, Epsilon: 0.9048147898403269
Episode: 300, Average reward: -182.49999999999986, Avg Loss: 43.51267494350672, Epsilon: 0.8606756897186528
Episode: 400, Average reward: -169.04999999999984, Avg Loss: 37.032258279025555, Epsilon: 0.8186898039137951
Episode: 500, Average reward: -170.09999999999985, Avg Loss: 30.679470774531364, Epsilon: 0.7787520933134615
Episode: 600, Average reward: -153.09999999999988, Avg Loss: 28.514423470944166, Epsilon: 0.7407626428726788
Episode: 700, Average reward: -153.64999999999986, Avg Loss: 26.78846615076065, Epsilon: 0.7046264116491338
Episode: 800, Average reward: -148.64999999999986, Avg Loss: 25.119721024483443, Epsilon: 0.6702529950324074
Episode: 900, Average reward: -141.84999999999988, Avg Loss: 23.71558097809553, Epsilon: 0.637556398572254
Episode: 1000, Average reward: -132.03699999999992, Avg Loss: 22.646040484160185, Epsilon: 0.606454822840097
Episode: 1100, Average reward: -124.54999999999993, Avg Loss: 21.736900651082397, Epsilon: 0.5768704587855094
Episode: 1200, Average reward: -120.74999999999993, Avg Loss: 20.776483507454394, Epsilon: 0.548729293075715
Episode: 1300, Average reward: -115.79999999999994, Avg Loss: 20.231148983687163, Epsilon: 0.5219609229311034
Episode: 1400, Average reward: -110.34999999999992, Avg Loss: 19.93027278892696, Epsilon: 0.49649837999353363
Episode: 1500, Average reward: -107.44999999999996, Avg Loss: 18.733834076821804, Epsilon: 0.4722779627867691
Episode: 1600, Average reward: -96.19999999999996, Avg Loss: 17.632236256301404, Epsilon: 0.44923907734991153
Episode: 1700, Average reward: -94.99999999999996, Avg Loss: 17.036789827905594, Epsilon: 0.4273240856451275
Episode: 1800, Average reward: -92.54999999999997, Avg Loss: 16.56152416795492, Epsilon: 0.406478161360422
Episode: 1900, Average reward: -88.19999999999996, Avg Loss: 16.121546249613164, Epsilon: 0.3866491527467055
Episode: 2000, Average reward: -82.6, Avg Loss: 15.81415419522673, Epsilon: 0.3677874521460121
Episode: 2100, Average reward: -76.3, Avg Loss: 13.992692082226277, Epsilon: 0.34984587188445015
Episode: 2200, Average reward: -72.6, Avg Loss: 11.87932962235529, Epsilon: 0.3327795262194029
Episode: 2300, Average reward: -70.1, Avg Loss: 11.12157979658572, Epsilon: 0.31654571904563433
Episode: 2400, Average reward: -68.25, Avg Loss: 10.8692001297581, Epsilon: 0.3011038370793723
Episode: 2500, Average reward: -64.7, Avg Loss: 11.003147931521525, Epsilon: 0.28641524825313086
Episode: 2600, Average reward: -61.95000000000002, Avg Loss: 10.882397992920597, Epsilon: 0.27244320506708813
Episode: 2700, Average reward: -59.40000000000002, Avg Loss: 10.65278827987495, Epsilon: 0.25915275265522114
Episode: 2800, Average reward: -56.05000000000002, Avg Loss: 11.00820296201622, Epsilon: 0.24651064133620196
Episode: 2900, Average reward: -57.70000000000002, Avg Loss: 11.416260290858336, Epsilon: 0.23448524343027585
Episode: 3000, Average reward: -54.70000000000002, Avg Loss: 11.707028221356449, Epsilon: 0.22304647413401948
Episode: 3100, Average reward: -51.40000000000002, Avg Loss: 11.3129378739011, Epsilon: 0.21216571625502262
Episode: 3200, Average reward: -50.55000000000002, Avg Loss: 11.338662880022312, Epsilon: 0.2018157486181985
Episode: 3300, Average reward: -50.55000000000002, Avg Loss: 11.383449502118747, Epsilon: 0.1919706779646106
Episode: 3400, Average reward: -46.600000000000016, Avg Loss: 11.53611306235427, Epsilon: 0.1826058741724434
Episode: 3500, Average reward: -46.20000000000002, Avg Loss: 11.502342133983621, Epsilon: 0.17369790863805412
Episode: 3600, Average reward: -45.20000000000002, Avg Loss: 11.024108852987993, Epsilon: 0.1652244956629483
Episode: 3700, Average reward: -43.050000000000026, Avg Loss: 10.905727700938588, Epsilon: 0.1571644367000449
Episode: 3800, Average reward: -39.95000000000002, Avg Loss: 10.89937125126191, Epsilon: 0.1494975673197442
Episode: 3900, Average reward: -41.15000000000002, Avg Loss: 10.80413867346011, Epsilon: 0.1422047067631241
Episode: 4000, Average reward: -36.30000000000001, Avg Loss: 10.758224464745144, Epsilon: 0.13526760995605422
Episode: 4100, Average reward: -39.550000000000026, Avg Loss: 10.780180668867542, Epsilon: 0.12866892186418147
Episode: 4200, Average reward: -36.750000000000014, Avg Loss: 10.602802142157453, Epsilon: 0.12239213407459068
Episode: 4300, Average reward: -34.90000000000002, Avg Loss: 10.733181801778265, Epsilon: 0.1164215434955208
Episode: 4400, Average reward: -36.20000000000002, Avg Loss: 10.659622337527107, Epsilon: 0.11074221307080971
Episode: 4500, Average reward: -31.50000000000001, Avg Loss: 10.680057348522242, Epsilon: 0.10533993441078586
Episode: 4600, Average reward: -35.80000000000001, Avg Loss: 10.716816571526579, Epsilon: 0.1002011922461172
Episode: 4700, Average reward: -32.20000000000001, Avg Loss: 10.4698944190162, Epsilon: 0.1
Episode: 4800, Average reward: -31.20000000000001, Avg Loss: 10.189780759805581, Epsilon: 0.1
Episode: 4900, Average reward: -32.45000000000001, Avg Loss: 10.163947983134422, Epsilon: 0.1
Episode: 5000, Average reward: -31.90000000000001, Avg Loss: 10.189090861537261, Epsilon: 0.1
Episode: 5100, Average reward: -33.150000000000006, Avg Loss: 10.11193298291677, Epsilon: 0.1
Episode: 5200, Average reward: -32.50000000000001, Avg Loss: 10.17654153305397, Epsilon: 0.1
Episode: 5300, Average reward: -31.95000000000001, Avg Loss: 10.201460363597725, Epsilon: 0.1
Episode: 5400, Average reward: -32.70000000000001, Avg Loss: 10.096060204377281, Epsilon: 0.1
Episode: 5500, Average reward: -31.85000000000001, Avg Loss: 10.119212941389414, Epsilon: 0.1
Episode: 5600, Average reward: -33.20000000000001, Avg Loss: 10.169220258292917, Epsilon: 0.1
Episode: 5700, Average reward: -33.10000000000001, Avg Loss: 10.238425430623465, Epsilon: 0.1
Episode: 5800, Average reward: -33.50000000000001, Avg Loss: 10.152080624041265, Epsilon: 0.1
Episode: 5900, Average reward: -31.15000000000001, Avg Loss: 10.054364925968693, Epsilon: 0.1
Episode: 6000, Average reward: -32.20000000000001, Avg Loss: 10.020237172081252, Epsilon: 0.1
Episode: 6100, Average reward: -32.80000000000001, Avg Loss: 10.119107163323788, Epsilon: 0.1
Episode: 6200, Average reward: -31.90000000000001, Avg Loss: 10.241532942630293, Epsilon: 0.1
Episode: 6300, Average reward: -30.50000000000001, Avg Loss: 10.098426922898216, Epsilon: 0.1
Episode: 6400, Average reward: -31.60000000000001, Avg Loss: 10.187811287885998, Epsilon: 0.1
Episode: 6500, Average reward: -29.300000000000008, Avg Loss: 10.062841859409819, Epsilon: 0.1
Episode: 6600, Average reward: -31.85000000000001, Avg Loss: 10.184353881229471, Epsilon: 0.1
Episode: 6700, Average reward: -32.45000000000001, Avg Loss: 10.072950838706456, Epsilon: 0.1
Episode: 6800, Average reward: -30.50000000000001, Avg Loss: 10.130205906173796, Epsilon: 0.1
Episode: 6900, Average reward: -30.550000000000008, Avg Loss: 10.080532081701094, Epsilon: 0.1
Episode: 7000, Average reward: -31.00000000000001, Avg Loss: 10.16501316315378, Epsilon: 0.1
Episode: 7100, Average reward: -32.30000000000001, Avg Loss: 10.309858921703999, Epsilon: 0.1
Episode: 7200, Average reward: -33.150000000000006, Avg Loss: 10.198895057290793, Epsilon: 0.1
Episode: 7300, Average reward: -30.95000000000001, Avg Loss: 10.200014239021112, Epsilon: 0.1
Episode: 7400, Average reward: -33.20000000000001, Avg Loss: 10.369181891800544, Epsilon: 0.1
Episode: 7500, Average reward: -31.50000000000001, Avg Loss: 10.336466899153601, Epsilon: 0.1
Episode: 7600, Average reward: -30.45000000000001, Avg Loss: 10.262653864389577, Epsilon: 0.1
Episode: 7700, Average reward: -32.850000000000016, Avg Loss: 10.259452000445453, Epsilon: 0.1
Episode: 7800, Average reward: -31.60000000000001, Avg Loss: 10.193479092835332, Epsilon: 0.1
Episode: 7900, Average reward: -33.65000000000001, Avg Loss: 10.10825266572705, Epsilon: 0.1
Episode: 8000, Average reward: -30.35000000000001, Avg Loss: 10.128044822465164, Epsilon: 0.1
Episode: 8100, Average reward: -30.70000000000001, Avg Loss: 10.057368100624007, Epsilon: 0.1
Episode: 8200, Average reward: -32.400000000000006, Avg Loss: 10.085783521990816, Epsilon: 0.1
Episode: 8300, Average reward: -29.20000000000001, Avg Loss: 10.125302104749426, Epsilon: 0.1
Episode: 8400, Average reward: -29.70000000000001, Avg Loss: 10.139365127696074, Epsilon: 0.1
Episode: 8500, Average reward: -31.10000000000001, Avg Loss: 10.29060748253134, Epsilon: 0.1
Episode: 8600, Average reward: -32.75000000000001, Avg Loss: 10.118044977571408, Epsilon: 0.1
Episode: 8700, Average reward: -30.25000000000001, Avg Loss: 10.193349296450323, Epsilon: 0.1
Episode: 8800, Average reward: -31.95000000000001, Avg Loss: 10.113758712576818, Epsilon: 0.1
Episode: 8900, Average reward: -30.550000000000008, Avg Loss: 10.098483155476861, Epsilon: 0.1
Episode: 9000, Average reward: -30.300000000000008, Avg Loss: 10.196435306136555, Epsilon: 0.1
Episode: 9100, Average reward: -32.00000000000001, Avg Loss: 10.048208679971577, Epsilon: 0.1
Episode: 9200, Average reward: -32.80000000000001, Avg Loss: 10.204959828413848, Epsilon: 0.1
Episode: 9300, Average reward: -34.05000000000001, Avg Loss: 10.084556875620038, Epsilon: 0.1
Episode: 9400, Average reward: -31.45000000000001, Avg Loss: 10.131290137906326, Epsilon: 0.1
Episode: 9500, Average reward: -34.400000000000006, Avg Loss: 10.130397892524488, Epsilon: 0.1
Episode: 9600, Average reward: -32.45000000000002, Avg Loss: 10.11675923841045, Epsilon: 0.1
Episode: 9700, Average reward: -33.10000000000001, Avg Loss: 10.123636671803542, Epsilon: 0.1
Episode: 9800, Average reward: -34.70000000000002, Avg Loss: 10.169733778173978, Epsilon: 0.1
Episode: 9900, Average reward: -33.10000000000001, Avg Loss: 10.260163982361846, Epsilon: 0.1
Episode: 10000, Average reward: -33.600000000000016, Avg Loss: 10.251315515082387, Epsilon: 0.1
