  0%|                                                                                                                              | 0/10000 [00:00<?, ?it/s]/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:47: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(state, dtype=torch.float32).to(self.device),
/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:50: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(next_state, dtype=torch.float32).to(self.device),
 32%|████████████████████████████████████▊                                                                              | 3199/10000 [14:33<27:34,  4.11it/s]
Episode: 100, Average reward: -217.19999999999985, Avg Loss: 188.1366773223877, Epsilon: 0.951217530242334
Episode: 200, Average reward: -196.29999999999984, Avg Loss: 97.00969425678254, Epsilon: 0.9048147898403269
Episode: 300, Average reward: -186.09999999999985, Avg Loss: 40.535404869019985, Epsilon: 0.8606756897186528
Episode: 400, Average reward: -177.49999999999986, Avg Loss: 35.393703040182594, Epsilon: 0.8186898039137951
Episode: 500, Average reward: -167.09999999999985, Avg Loss: 31.57002999484539, Epsilon: 0.7787520933134615
Episode: 600, Average reward: -157.24999999999986, Avg Loss: 29.061568646728993, Epsilon: 0.7407626428726788
Episode: 700, Average reward: -150.6499999999999, Avg Loss: 27.204663581550122, Epsilon: 0.7046264116491338
Episode: 800, Average reward: -140.2999999999999, Avg Loss: 25.195606549233197, Epsilon: 0.6702529950324074
Episode: 900, Average reward: -145.59999999999988, Avg Loss: 24.42053666934371, Epsilon: 0.637556398572254
Episode: 1000, Average reward: -131.74999999999991, Avg Loss: 23.05809365749359, Epsilon: 0.606454822840097
Episode: 1100, Average reward: -119.59999999999992, Avg Loss: 20.740437598973514, Epsilon: 0.5768704587855094
Episode: 1200, Average reward: -118.84999999999992, Avg Loss: 19.970920460671188, Epsilon: 0.548729293075715
Episode: 1300, Average reward: -113.24999999999993, Avg Loss: 20.54817409157753, Epsilon: 0.5219609229311034
Episode: 1400, Average reward: -104.99999999999996, Avg Loss: 20.095683626234532, Epsilon: 0.49649837999353363
Episode: 1500, Average reward: -103.64999999999996, Avg Loss: 18.991855985447764, Epsilon: 0.4722779627867691
Episode: 1600, Average reward: -101.54999999999997, Avg Loss: 17.854570291489363, Epsilon: 0.44923907734991153
Episode: 1700, Average reward: -96.29999999999997, Avg Loss: 16.964744432978332, Epsilon: 0.4273240856451275
Episode: 1800, Average reward: -91.99999999999999, Avg Loss: 15.993490823470056, Epsilon: 0.406478161360422
Episode: 1900, Average reward: -87.84999999999997, Avg Loss: 15.951121741086245, Epsilon: 0.3866491527467055
Episode: 2000, Average reward: -86.44999999999999, Avg Loss: 16.52310584850609, Epsilon: 0.3677874521460121
Episode: 2100, Average reward: -86.09999999999998, Avg Loss: 16.17723388787359, Epsilon: 0.34984587188445015
Episode: 2200, Average reward: -79.1, Avg Loss: 15.403261674270034, Epsilon: 0.3327795262194029
Episode: 2300, Average reward: -73.7, Avg Loss: 14.223699791580438, Epsilon: 0.31654571904563433
Episode: 2400, Average reward: -70.8, Avg Loss: 13.666862669824623, Epsilon: 0.3011038370793723
Episode: 2500, Average reward: -64.2, Avg Loss: 12.726429843977094, Epsilon: 0.28641524825313086
Episode: 2600, Average reward: -61.50000000000002, Avg Loss: 11.155113397679525, Epsilon: 0.27244320506708813
Episode: 2700, Average reward: -61.25000000000001, Avg Loss: 10.352396530461265, Epsilon: 0.25915275265522114
Episode: 2800, Average reward: -54.15000000000002, Avg Loss: 10.054054849718813, Epsilon: 0.24651064133620196
Episode: 2900, Average reward: -54.850000000000016, Avg Loss: 9.855290208452498, Epsilon: 0.23448524343027585
Episode: 3000, Average reward: -52.80000000000002, Avg Loss: 10.04479692681285, Epsilon: 0.22304647413401948
Episode: 3100, Average reward: -53.90000000000002, Avg Loss: 10.157261328602909, Epsilon: 0.21216571625502262
Episode: 3200, Average reward: -49.15000000000002, Avg Loss: 9.922753407735145, Epsilon: 0.2018157486181985
Episode: 3300, Average reward: -47.100000000000016, Avg Loss: 9.92531803632388, Epsilon: 0.1919706779646106
Episode: 3400, Average reward: -46.55000000000002, Avg Loss: 9.920276686531434, Epsilon: 0.1826058741724434
Episode: 3500, Average reward: -41.65000000000002, Avg Loss: 9.762369348876819, Epsilon: 0.17369790863805412
Episode: 3600, Average reward: -44.45000000000002, Avg Loss: 9.801757165929885, Epsilon: 0.1652244956629483
Episode: 3700, Average reward: -43.40000000000002, Avg Loss: 9.702940630071389, Epsilon: 0.1571644367000449
Episode: 3800, Average reward: -41.55000000000002, Avg Loss: 9.762195456061454, Epsilon: 0.1494975673197442
Episode: 3900, Average reward: -38.50000000000002, Avg Loss: 9.750349554023996, Epsilon: 0.1422047067631241
Episode: 4000, Average reward: -38.600000000000016, Avg Loss: 9.905573115483566, Epsilon: 0.13526760995605422
Episode: 4100, Average reward: -37.350000000000016, Avg Loss: 9.765665793928783, Epsilon: 0.12866892186418147
Episode: 4200, Average reward: -37.65000000000002, Avg Loss: 9.90166548474168, Epsilon: 0.12239213407459068
Episode: 4300, Average reward: -33.80000000000001, Avg Loss: 9.751014035199187, Epsilon: 0.1164215434955208
Episode: 4400, Average reward: -34.400000000000006, Avg Loss: 9.791305201606884, Epsilon: 0.11074221307080971
Episode: 4500, Average reward: -32.30000000000001, Avg Loss: 9.700325748438772, Epsilon: 0.10533993441078586
Episode: 4600, Average reward: -30.00000000000001, Avg Loss: 9.627506075504352, Epsilon: 0.1002011922461172
Episode: 4700, Average reward: -33.000000000000014, Avg Loss: 9.58637346842006, Epsilon: 0.1
Episode: 4800, Average reward: -32.65000000000001, Avg Loss: 9.640343919341976, Epsilon: 0.1
Episode: 4900, Average reward: -33.15000000000001, Avg Loss: 9.650599899751832, Epsilon: 0.1
Episode: 5000, Average reward: -31.50000000000001, Avg Loss: 9.553430513508793, Epsilon: 0.1
Episode: 5100, Average reward: -31.300000000000008, Avg Loss: 9.691616772330017, Epsilon: 0.1
Episode: 5200, Average reward: -29.50000000000001, Avg Loss: 9.616031051906758, Epsilon: 0.1
Episode: 5300, Average reward: -31.700000000000014, Avg Loss: 9.833301109248422, Epsilon: 0.1
Episode: 5400, Average reward: -29.75000000000001, Avg Loss: 9.682442422571766, Epsilon: 0.1
Episode: 5500, Average reward: -31.90000000000001, Avg Loss: 9.766360245022806, Epsilon: 0.1
Episode: 5600, Average reward: -31.90000000000001, Avg Loss: 9.62214643103187, Epsilon: 0.1
Episode: 5700, Average reward: -29.850000000000005, Avg Loss: 9.688571517602831, Epsilon: 0.1
Episode: 5800, Average reward: -30.45000000000001, Avg Loss: 9.652446390676197, Epsilon: 0.1
Episode: 5900, Average reward: -33.45000000000001, Avg Loss: 9.663924790974415, Epsilon: 0.1
Episode: 6000, Average reward: -31.250000000000014, Avg Loss: 9.70806724605558, Epsilon: 0.1
Episode: 6100, Average reward: -34.35000000000001, Avg Loss: 9.616245418834442, Epsilon: 0.1
Episode: 6200, Average reward: -30.15000000000001, Avg Loss: 9.669512726175308, Epsilon: 0.1
Episode: 6300, Average reward: -32.05000000000001, Avg Loss: 9.686526183502282, Epsilon: 0.1
Episode: 6400, Average reward: -31.35000000000001, Avg Loss: 9.79102246886905, Epsilon: 0.1
Episode: 6500, Average reward: -31.35000000000001, Avg Loss: 9.760888551208772, Epsilon: 0.1
Episode: 6600, Average reward: -34.00000000000001, Avg Loss: 9.565044539516384, Epsilon: 0.1
Episode: 6700, Average reward: -30.25000000000001, Avg Loss: 9.728017760036746, Epsilon: 0.1
Episode: 6800, Average reward: -31.90000000000001, Avg Loss: 9.792185388877988, Epsilon: 0.1
Episode: 6900, Average reward: -29.70000000000001, Avg Loss: 9.704553292836353, Epsilon: 0.1
Episode: 7000, Average reward: -31.20000000000001, Avg Loss: 9.768948334969755, Epsilon: 0.1
Episode: 7100, Average reward: -31.25000000000001, Avg Loss: 9.663991396090715, Epsilon: 0.1
Episode: 7200, Average reward: -32.25000000000001, Avg Loss: 9.784462409057305, Epsilon: 0.1
Episode: 7300, Average reward: -30.70000000000001, Avg Loss: 9.737450692813727, Epsilon: 0.1
Episode: 7400, Average reward: -31.75000000000001, Avg Loss: 9.670512875230342, Epsilon: 0.1
Episode: 7500, Average reward: -30.35000000000001, Avg Loss: 9.708798244040226, Epsilon: 0.1
Episode: 7600, Average reward: -30.25000000000001, Avg Loss: 9.762022498387669, Epsilon: 0.1
Episode: 7700, Average reward: -33.80000000000001, Avg Loss: 9.745252791210369, Epsilon: 0.1
Episode: 7800, Average reward: -31.550000000000015, Avg Loss: 9.685229237155582, Epsilon: 0.1
Episode: 7900, Average reward: -32.00000000000001, Avg Loss: 9.770463292053318, Epsilon: 0.1
Episode: 8000, Average reward: -31.25000000000001, Avg Loss: 9.669957162255596, Epsilon: 0.1
Episode: 8100, Average reward: -29.75000000000001, Avg Loss: 9.684646533867635, Epsilon: 0.1
Episode: 8200, Average reward: -33.25000000000001, Avg Loss: 9.750018608106766, Epsilon: 0.1
Episode: 8300, Average reward: -30.950000000000003, Avg Loss: 9.675859354777204, Epsilon: 0.1
Episode: 8400, Average reward: -32.55000000000001, Avg Loss: 9.70984160384338, Epsilon: 0.1
Episode: 8500, Average reward: -30.65000000000001, Avg Loss: 9.678578402911372, Epsilon: 0.1
Episode: 8600, Average reward: -31.65000000000001, Avg Loss: 9.67383338548185, Epsilon: 0.1
Episode: 8700, Average reward: -33.70000000000002, Avg Loss: 9.61872155422694, Epsilon: 0.1
Episode: 8800, Average reward: -32.35000000000001, Avg Loss: 9.659279747418477, Epsilon: 0.1
Episode: 8900, Average reward: -29.90000000000001, Avg Loss: 9.679848871859722, Epsilon: 0.1
Episode: 9000, Average reward: -30.40000000000001, Avg Loss: 9.67912781941297, Epsilon: 0.1
Episode: 9100, Average reward: -32.85000000000001, Avg Loss: 9.708927167442452, Epsilon: 0.1
Episode: 9200, Average reward: -31.70000000000001, Avg Loss: 9.640805716259639, Epsilon: 0.1
Episode: 9300, Average reward: -32.85000000000001, Avg Loss: 9.632939133184845, Epsilon: 0.1
Episode: 9400, Average reward: -31.450000000000014, Avg Loss: 9.711364340387517, Epsilon: 0.1
Episode: 9500, Average reward: -31.15000000000001, Avg Loss: 9.806142184280034, Epsilon: 0.1
Episode: 9600, Average reward: -32.70000000000002, Avg Loss: 9.709572043805384, Epsilon: 0.1
Episode: 9700, Average reward: -34.05000000000001, Avg Loss: 9.704439320137608, Epsilon: 0.1
Episode: 9800, Average reward: -31.300000000000008, Avg Loss: 9.787727938129683, Epsilon: 0.1
Episode: 9900, Average reward: -31.00000000000001, Avg Loss: 9.676058484459936, Epsilon: 0.1
Episode: 10000, Average reward: -30.15000000000001, Avg Loss: 9.728399831301067, Epsilon: 0.1
