  0%|                                                                                                                              | 0/10000 [00:00<?, ?it/s]/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:47: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(state, dtype=torch.float32).to(self.device),
/home/chunyulin/Desktop/DRL/DRL-Asignment-1/utils.py:50: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(next_state, dtype=torch.float32).to(self.device),
 32%|████████████████████████████████████▊                                                                              | 3199/10000 [11:43<25:23,  4.46it/s]
Episode: 100, Average reward: -208.99999999999986, Avg Loss: 168.95959369182586, Epsilon: 0.951217530242334
Episode: 200, Average reward: -200.54999999999984, Avg Loss: 74.97019186973571, Epsilon: 0.9048147898403269
Episode: 300, Average reward: -183.44999999999985, Avg Loss: 37.662915666103366, Epsilon: 0.8606756897186528
Episode: 400, Average reward: -172.19999999999985, Avg Loss: 33.114154263436795, Epsilon: 0.8186898039137951
Episode: 500, Average reward: -165.09999999999985, Avg Loss: 30.63180731922388, Epsilon: 0.7787520933134615
Episode: 600, Average reward: -156.79999999999987, Avg Loss: 28.604467916488648, Epsilon: 0.7407626428726788
Episode: 700, Average reward: -150.1499999999999, Avg Loss: 26.71585139989853, Epsilon: 0.7046264116491338
Episode: 800, Average reward: -143.8999999999999, Avg Loss: 25.08881340801716, Epsilon: 0.6702529950324074
Episode: 900, Average reward: -133.6769999999999, Avg Loss: 24.599133060276507, Epsilon: 0.637556398572254
Episode: 1000, Average reward: -130.59999999999988, Avg Loss: 23.45962245732546, Epsilon: 0.606454822840097
Episode: 1100, Average reward: -129.79999999999993, Avg Loss: 21.0808062607795, Epsilon: 0.5768704587855094
Episode: 1200, Average reward: -119.24999999999993, Avg Loss: 19.52806759223342, Epsilon: 0.548729293075715
Episode: 1300, Average reward: -112.94999999999995, Avg Loss: 18.75651444092393, Epsilon: 0.5219609229311034
Episode: 1400, Average reward: -110.04999999999994, Avg Loss: 18.976300804018976, Epsilon: 0.49649837999353363
Episode: 1500, Average reward: -103.64999999999995, Avg Loss: 19.274374829530714, Epsilon: 0.4722779627867691
Episode: 1600, Average reward: -102.29999999999997, Avg Loss: 18.3794061492756, Epsilon: 0.44923907734991153
Episode: 1700, Average reward: -93.54999999999997, Avg Loss: 17.410680567026137, Epsilon: 0.4273240856451275
Episode: 1800, Average reward: -96.14999999999996, Avg Loss: 16.90978823542595, Epsilon: 0.406478161360422
Episode: 1900, Average reward: -89.39999999999996, Avg Loss: 16.274810704290868, Epsilon: 0.3866491527467055
Episode: 2000, Average reward: -84.79999999999998, Avg Loss: 15.672708812616765, Epsilon: 0.3677874521460121
Episode: 2100, Average reward: -80.24999999999999, Avg Loss: 14.322140850685537, Epsilon: 0.34984587188445015
Episode: 2200, Average reward: -70.65, Avg Loss: 12.378923148103059, Epsilon: 0.3327795262194029
Episode: 2300, Average reward: -68.9, Avg Loss: 10.931386957318756, Epsilon: 0.31654571904563433
Episode: 2400, Average reward: -66.9, Avg Loss: 10.506280567975482, Epsilon: 0.3011038370793723
Episode: 2500, Average reward: -65.0, Avg Loss: 10.35234940073802, Epsilon: 0.28641524825313086
Episode: 2600, Average reward: -64.45, Avg Loss: 10.252179416354629, Epsilon: 0.27244320506708813
Episode: 2700, Average reward: -60.40000000000002, Avg Loss: 10.165103578237467, Epsilon: 0.25915275265522114
Episode: 2800, Average reward: -57.20000000000002, Avg Loss: 10.238555974687916, Epsilon: 0.24651064133620196
Episode: 2900, Average reward: -56.45000000000002, Avg Loss: 10.152644424889585, Epsilon: 0.23448524343027585
Episode: 3000, Average reward: -55.55000000000002, Avg Loss: 10.288219700701884, Epsilon: 0.22304647413401948
Episode: 3100, Average reward: -50.80000000000002, Avg Loss: 10.160483004186535, Epsilon: 0.21216571625502262
Episode: 3200, Average reward: -49.90000000000002, Avg Loss: 9.967357901766082, Epsilon: 0.2018157486181985
Episode: 3300, Average reward: -51.350000000000016, Avg Loss: 9.985750511120422, Epsilon: 0.1919706779646106
Episode: 3400, Average reward: -45.050000000000026, Avg Loss: 10.078857701607049, Epsilon: 0.1826058741724434
Episode: 3500, Average reward: -43.90000000000002, Avg Loss: 10.099051267165924, Epsilon: 0.17369790863805412
Episode: 3600, Average reward: -42.850000000000016, Avg Loss: 9.878187839502935, Epsilon: 0.1652244956629483
Episode: 3700, Average reward: -44.45000000000002, Avg Loss: 9.914529418904568, Epsilon: 0.1571644367000449
Episode: 3800, Average reward: -39.65000000000002, Avg Loss: 9.981419797734416, Epsilon: 0.1494975673197442
Episode: 3900, Average reward: -38.80000000000002, Avg Loss: 9.892356644273969, Epsilon: 0.1422047067631241
Episode: 4000, Average reward: -37.850000000000016, Avg Loss: 9.827719466093987, Epsilon: 0.13526760995605422
Episode: 4100, Average reward: -36.05000000000001, Avg Loss: 9.770670363166428, Epsilon: 0.12866892186418147
Episode: 4200, Average reward: -35.25000000000001, Avg Loss: 9.897372590283048, Epsilon: 0.12239213407459068
Episode: 4300, Average reward: -35.50000000000002, Avg Loss: 10.079021731230023, Epsilon: 0.1164215434955208
Episode: 4400, Average reward: -35.75000000000001, Avg Loss: 9.943538481759024, Epsilon: 0.11074221307080971
Episode: 4500, Average reward: -33.35000000000001, Avg Loss: 9.877674248463881, Epsilon: 0.10533993441078586
Episode: 4600, Average reward: -30.70000000000001, Avg Loss: 9.755884720050672, Epsilon: 0.1002011922461172
Episode: 4700, Average reward: -32.55000000000001, Avg Loss: 9.831874267043021, Epsilon: 0.1
Episode: 4800, Average reward: -32.55000000000001, Avg Loss: 9.751516624647484, Epsilon: 0.1
Episode: 4900, Average reward: -30.00000000000001, Avg Loss: 9.699800074457599, Epsilon: 0.1
Episode: 5000, Average reward: -32.30000000000001, Avg Loss: 9.733943725247808, Epsilon: 0.1
Episode: 5100, Average reward: -31.20000000000001, Avg Loss: 9.801065692070697, Epsilon: 0.1
Episode: 5200, Average reward: -33.60000000000001, Avg Loss: 9.869338993337587, Epsilon: 0.1
Episode: 5300, Average reward: -30.45000000000001, Avg Loss: 9.810802339800285, Epsilon: 0.1
Episode: 5400, Average reward: -32.70000000000001, Avg Loss: 9.714100605603889, Epsilon: 0.1
Episode: 5500, Average reward: -29.300000000000008, Avg Loss: 9.735903624993226, Epsilon: 0.1
Episode: 5600, Average reward: -32.55000000000001, Avg Loss: 9.81403447696095, Epsilon: 0.1
Episode: 5700, Average reward: -32.150000000000006, Avg Loss: 9.678757681993885, Epsilon: 0.1
Episode: 5800, Average reward: -33.45000000000001, Avg Loss: 9.782489976256329, Epsilon: 0.1
Episode: 5900, Average reward: -32.95000000000002, Avg Loss: 9.773190492785652, Epsilon: 0.1
Episode: 6000, Average reward: -32.500000000000014, Avg Loss: 9.605581116438552, Epsilon: 0.1
Episode: 6100, Average reward: -31.90000000000001, Avg Loss: 9.871472024893155, Epsilon: 0.1
Episode: 6200, Average reward: -28.550000000000004, Avg Loss: 9.763596792547323, Epsilon: 0.1
Episode: 6300, Average reward: -32.100000000000016, Avg Loss: 9.76501285821112, Epsilon: 0.1
Episode: 6400, Average reward: -32.35000000000001, Avg Loss: 9.7829165858301, Epsilon: 0.1
Episode: 6500, Average reward: -31.550000000000008, Avg Loss: 9.70941855672456, Epsilon: 0.1
Episode: 6600, Average reward: -30.25000000000001, Avg Loss: 9.787477551317716, Epsilon: 0.1
Episode: 6700, Average reward: -31.35000000000001, Avg Loss: 9.760621358504578, Epsilon: 0.1
Episode: 6800, Average reward: -32.900000000000006, Avg Loss: 9.799907645090133, Epsilon: 0.1
Episode: 6900, Average reward: -32.55000000000001, Avg Loss: 9.886982252292219, Epsilon: 0.1
Episode: 7000, Average reward: -33.70000000000002, Avg Loss: 9.65952573693794, Epsilon: 0.1
Episode: 7100, Average reward: -30.800000000000008, Avg Loss: 9.778193265791343, Epsilon: 0.1
Episode: 7200, Average reward: -33.45000000000001, Avg Loss: 9.80657960363431, Epsilon: 0.1
Episode: 7300, Average reward: -31.90000000000001, Avg Loss: 9.83253631130734, Epsilon: 0.1
Episode: 7400, Average reward: -34.15000000000001, Avg Loss: 9.716932522293355, Epsilon: 0.1
Episode: 7500, Average reward: -33.60000000000001, Avg Loss: 9.701964376232063, Epsilon: 0.1
Episode: 7600, Average reward: -33.75000000000001, Avg Loss: 9.845070651901187, Epsilon: 0.1
Episode: 7700, Average reward: -31.95000000000001, Avg Loss: 9.782429981062887, Epsilon: 0.1
Episode: 7800, Average reward: -31.35000000000001, Avg Loss: 9.747111423545576, Epsilon: 0.1
Episode: 7900, Average reward: -30.550000000000008, Avg Loss: 9.79383769132546, Epsilon: 0.1
Episode: 8000, Average reward: -31.800000000000008, Avg Loss: 9.823793860027799, Epsilon: 0.1
Episode: 8100, Average reward: -32.80000000000001, Avg Loss: 9.744653303008235, Epsilon: 0.1
Episode: 8200, Average reward: -30.800000000000008, Avg Loss: 9.67169852901192, Epsilon: 0.1
Episode: 8300, Average reward: -32.55000000000001, Avg Loss: 9.788667633158038, Epsilon: 0.1
Episode: 8400, Average reward: -32.80000000000001, Avg Loss: 9.711859795998897, Epsilon: 0.1
Episode: 8500, Average reward: -32.05000000000001, Avg Loss: 9.868537554873619, Epsilon: 0.1
Episode: 8600, Average reward: -31.25000000000001, Avg Loss: 9.67220499437215, Epsilon: 0.1
Episode: 8700, Average reward: -31.75000000000001, Avg Loss: 9.767808611722721, Epsilon: 0.1
Episode: 8800, Average reward: -34.30000000000001, Avg Loss: 9.7639936886722, Epsilon: 0.1
Episode: 8900, Average reward: -32.400000000000006, Avg Loss: 9.879874591502302, Epsilon: 0.1
Episode: 9000, Average reward: -31.45000000000001, Avg Loss: 9.794810798255202, Epsilon: 0.1
Episode: 9100, Average reward: -32.00000000000001, Avg Loss: 9.696271732424503, Epsilon: 0.1
Episode: 9200, Average reward: -31.50000000000001, Avg Loss: 9.740398509312945, Epsilon: 0.1
Episode: 9300, Average reward: -31.35000000000001, Avg Loss: 9.730684116099438, Epsilon: 0.1
Episode: 9400, Average reward: -28.90000000000001, Avg Loss: 9.70557338783925, Epsilon: 0.1
Episode: 9500, Average reward: -31.15000000000001, Avg Loss: 9.838538193157001, Epsilon: 0.1
Episode: 9600, Average reward: -33.900000000000006, Avg Loss: 9.673354128366045, Epsilon: 0.1
Episode: 9700, Average reward: -32.30000000000001, Avg Loss: 9.79067412808159, Epsilon: 0.1
Episode: 9800, Average reward: -33.50000000000001, Avg Loss: 9.760464469148138, Epsilon: 0.1
Episode: 9900, Average reward: -32.000000000000014, Avg Loss: 9.682662801996049, Epsilon: 0.1
Episode: 10000, Average reward: -32.45000000000001, Avg Loss: 9.773797439215706, Epsilon: 0.1
